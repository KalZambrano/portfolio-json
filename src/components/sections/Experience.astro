---
import SectionContainer from "../SectionContainer.astro";

const { work, title } = Astro.props;
---

<SectionContainer title={title} animate="animate-fade-in-right animate-delay-400">
  <div class="space-y-8">
    {
      work.map(
        ({ name, startDate, endDate, position, summary, url }) => {
          const startYear = new Date(startDate).getFullYear();
          const endYear = endDate != null ? new Date(endDate).getFullYear() : "Actual";
          const isCurrent = !endDate;

          return (
            <div class="group relative pl-6">
              {/* Timeline dot */}
              <div class="absolute left-0 top-2 h-3 w-3 rounded-full border-2 border-amber-500 bg-white dark:border-amber-400 dark:bg-zinc-900">
                {isCurrent && (
                  <span class="absolute inset-0 -z-10 flex h-full w-full animate-ping rounded-full bg-amber-400/30"></span>
                )}
              </div>
              
              {/* Timeline line */}
              <div class="absolute left-1.25 top-5 -bottom-8 w-0.5 bg-linear-to-b from-amber-400 to-transparent dark:from-amber-500"></div>

              <article class="relative rounded-xl p-4 transition-all duration-200 hover:bg-white/50 dark:hover:bg-zinc-800/50">
                <div class="flex flex-col gap-1 sm:flex-row sm:items-start sm:justify-between">
                  <div>
                    <h3 class="text-base font-semibold text-zinc-900 dark:text-white">
                      <a
                        href={url}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="group-hover:text-amber-600 dark:group-hover:text-amber-400"
                      >
                        {name}
                        <span class="ml-1.5 inline-block transition-transform duration-200 group-hover:translate-x-0.5">↗</span>
                      </a>
                    </h3>
                    <h4 class="text-sm font-medium text-zinc-600 dark:text-zinc-300">
                      {position}
                    </h4>
                  </div>
                  
                  <time class="inline-flex items-center rounded-full bg-zinc-100 px-2.5 py-0.5 text-xs font-medium text-zinc-800 dark:bg-zinc-700/50 dark:text-zinc-200 sm:mt-1">
                    {startYear} — {endYear}
                    {isCurrent && (
                      <span class="ml-1.5 flex h-1.5 w-1.5 items-center justify-center">
                        <span class="absolute h-2 w-2 animate-ping rounded-full bg-amber-400"></span>
                        <span class="h-1.5 w-1.5 rounded-full bg-amber-500"></span>
                      </span>
                    )}
                  </time>
                </div>

                <p class="mt-2 text-sm leading-relaxed text-zinc-600 dark:text-zinc-300">
                  {summary}
                </p>
              </article>
            </div>
          );
        }
      )
    }
  </div>
</SectionContainer>
